import sqlite3

DB_PATH = "database/energy.db"


def get_connection():
    conn = sqlite3.connect(DB_PATH)
    conn.row_factory = sqlite3.Row
    return conn


def create_table():
    conn = get_connection()
    cursor = conn.cursor()

    cursor.execute("""
    CREATE TABLE IF NOT EXISTS energy_data (

        id INTEGER PRIMARY KEY AUTOINCREMENT,

        Machine_ID TEXT,

        Machine_Model TEXT,

        Rated_Capacity_kW REAL,

        Timestamp TEXT,

        Power_kW REAL,

        Energy_kWh REAL,

        Production_Output REAL,

        Load_percent REAL,

        Power_Factor REAL,

        Temperature REAL,

        Operating_Status TEXT,

        Shift TEXT,

        Operator_ID TEXT,

        Electricity_Tariff REAL,

        Maintenance_Cost_per_hour REAL,

        CO2_Emission_Factor REAL

    )
    """)

    conn.commit()
    conn.close()